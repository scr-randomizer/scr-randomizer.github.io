<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCR Randomizer</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --app-scale: 1.7; 
            --internal-width: 320px;
            --internal-height: 450px;
            --offset-x: -36px;
            --offset-y: -37px;
        }

        @media (max-width: 600px) {
            :root {
                --app-scale: 1; 
                --offset-x: 0px; 
                --offset-y: 36px;
            }
        }

        body { 
            font-family: 'Ubuntu', sans-serif; 
            text-align: center; 
            background-color: #10203B; 
            margin: 0;
            padding: 5px;
            color: #1C1C1C;
        }
        
        .container { 
            max-width: 900px; 
            margin: auto; 
            padding: 30px 20px; 
            background: #5C6971; 
            border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* App Wrapper & Cropping */
        #app-wrapper {
            width: calc(var(--internal-width) * var(--app-scale));
            height: calc(var(--internal-height) * var(--app-scale));
            margin: 15px auto;
            overflow: hidden;
            position: relative;
            border: 4px solid #1C1C1C;
            border-radius: 12px;
            background: #000;
            transition: all 0.3s ease; /* Smooth transition when toggling */
        }

        #app-wrapper iframe {
            width: 392px;
            height: 620px;
            border: none;
            position: absolute;
            top: calc(var(--offset-y) * var(--app-scale));
            left: calc(var(--offset-x) * var(--app-scale));
            transform: scale(var(--app-scale));
            transform-origin: top left;
        }

        /* Fullscreen Mode Styles */
        #app-wrapper.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999;
            border: none;
            border-radius: 0;
            background: #10203B;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Adjusting the scale in Fullscreen to fit screen height */
        #app-wrapper.fullscreen iframe {
            --fs-scale: 2.1; /* Scale for desktop fullscreen */
            transform: scale(var(--fs-scale));
            top: calc(var(--offset-y) * var(--fs-scale) + 50% - (var(--internal-height) * var(--fs-scale) / 2));
            left: calc(var(--offset-x) * var(--fs-scale) + 50% - (var(--internal-width) * var(--fs-scale) / 2));
        }

        /* Fullscreen Mobile override */
        @media (max-width: 600px) {
            #app-wrapper.fullscreen iframe {
                --fs-scale: 1.4; /* Scale for mobile fullscreen */
            }
        }

        /* Button Styling */
        .btn-action {
            background: #1C1C1C;
            color: white;
            border: none;
            padding: 10px 5px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Ubuntu', sans-serif;
            margin: 10px;
            transition: 0.2s;
        }

        .btn-action:hover { background: #2F8CF9; }

        .title-image { max-width: 100%; height: auto; }
        .repo-link a { color: #2F8CF9; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container">
        <img style='scale:0.5' src="assets/randomizerlogostatic.png" alt="SCR Randomizer" class="title-image">
        
        <p class="repo-link">
            Welcome! <b>Click the screen to start. </b>  <a href="https://github.com/scr-randomizer/home/">Visit the Repository</a>
        </p>

        <button class="btn-action" onclick="toggleFullscreen()">Full Screen Mode</button>
        <button class="btn-action" onclick="reloadApp()">Reload App</button>
        
        <div id="app-wrapper">
            <iframe id="randomizer-app" src="https://studio.code.org/projects/applab/oX2jWo6MP1MyG8B7RbwRQEXkhEfASOZKkOQTkTyByxR/embed?nosource"></iframe>
        </div>

        <div style="margin-top: 20px;">
            <a href='https://ko-fi.com/R6R71RH2ZF' target='_blank'>
                <img height='36' src='https://storage.ko-fi.com/cdn/kofi5.png?v=6' alt='Buy Me a Coffee' />
            </a>
        </div>
    </div>

    <script>
        function toggleFullscreen() {
            const app = document.getElementById('app-wrapper');
            app.classList.toggle('fullscreen');
            
            // Change button text based on state
            const btn = document.querySelector('.btn-action');
            if(app.classList.contains('fullscreen')) {
                btn.innerText = "Exit Full Screen";
            } else {
                btn.innerText = "Full Screen Mode";
            }
        }

        function reloadApp() {
            const iframe = document.getElementById('randomizer-app');
            iframe.src = iframe.src; // Simple way to refresh an iframe
        }

        // Allow pressing 'Esc' to exit fullscreen
        document.addEventListener('keydown', (e) => {
            if (e.key === "Escape") {
                const app = document.getElementById('app-wrapper');
                if(app.classList.contains('fullscreen')) toggleFullscreen();
            }
        });
    </script>

</body>
</html>
